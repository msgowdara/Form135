<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bank Form 135 - Digital Filler (Offline)</title>
    
    <!-- 
      OFFLINE INSTRUCTIONS:
      If using on a PC without internet, download these two files and place them in the same folder:
      1. jspdf.umd.min.js
      2. jspdf.plugin.autotable.min.js
      Then change the 'src' below to just the filename (e.g., src="jspdf.umd.min.js").
    -->
    <script src="jspdf.umd.min.js"></script>
    <script src="jspdf.plugin.autotable.min.js"></script>

    <style>
        /* --- INTERNAL CSS (No Internet Required) --- */
        :root {
            --bg-dark: #111827;
            --bg-card: #1f2937;
            --text-main: #f3f4f6;
            --text-muted: #9ca3af;
            --primary: #ea580c; /* Orange */
            --primary-hover: #c2410c;
            --border: #374151;
            --input-bg: #f3f4f6; /* Light gray for inputs */
            --input-text: #111827; /* Dark text for inputs */
        }

        body {
            font-family: sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-main);
            margin: 0;
            padding-bottom: 80px;
            box-sizing: border-box;
        }

        *, *::before, *::after { box-sizing: inherit; }

        /* Layout Utilities */
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .hidden { display: none !important; }
        .flex { display: flex; }
        .flex-wrap { flex-wrap: wrap; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .gap-2 { gap: 0.5rem; }
        .gap-4 { gap: 1rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .w-full { width: 100%; }
        .text-center { text-align: center; }
        .font-bold { font-weight: bold; }
        
        /* Grid System */
        .grid { display: grid; gap: 1rem; }
        .grid-cols-1 { grid-template-columns: 1fr; }
        @media (min-width: 768px) {
            .grid-cols-2 { grid-template-columns: 1fr 1fr; }
            .grid-cols-3 { grid-template-columns: 1fr 1fr 1fr; }
            .col-span-2 { grid-column: span 2; }
        }

        /* Components */
        .navbar {
            background-color: var(--bg-card);
            border-bottom: 1px solid var(--border);
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .disclaimer {
            background-color: #000;
            color: #fb923c;
            text-align: center;
            padding: 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
            border-bottom: 1px solid var(--border);
        }

        .form-section {
            background-color: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .section-title {
            font-size: 1.25rem;
            color: #fb923c;
            border-bottom: 1px solid #4b5563;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        /* Inputs */
        .input-group { margin-bottom: 1rem; }
        .input-label { display: block; font-size: 0.875rem; color: #d1d5db; margin-bottom: 0.25rem; font-weight: 500; }
        
        /* High Contrast Input Styling */
        .form-input {
            width: 100%;
            padding: 0.5rem;
            border: 2px solid #6b7280;
            border-radius: 0.375rem;
            background-color: var(--input-bg);
            color: var(--input-text);
            font-size: 0.9rem;
            font-weight: 600; /* Bolder text for visibility */
        }
        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(234, 88, 12, 0.3);
            background-color: #ffffff;
        }
        .form-input:read-only { background-color: #9ca3af; color: #111827; cursor: not-allowed; }
        .form-input:invalid { border-color: #ef4444; background-color: #fecaca; }

        /* Tables */
        .table-wrapper { overflow-x: auto; border: 1px solid var(--border); border-radius: 0.375rem; margin-bottom: 0.5rem; }
        table { width: 100%; border-collapse: collapse; min-width: 600px; }
        th { 
            background-color: #374151; 
            color: #e5e7eb; 
            font-size: 0.75rem; 
            text-align: left; 
            padding: 0.5rem; 
            border: 1px solid #4b5563; 
            white-space: nowrap;
        }
        td { border: 1px solid #4b5563; padding: 0.25rem; }
        
        .table-input {
            width: 100%;
            border: 1px solid #9ca3af;
            border-radius: 0.25rem;
            padding: 0.25rem;
            background-color: var(--input-bg);
            color: var(--input-text);
            font-size: 0.85rem;
            font-weight: 500;
        }
        .table-input:focus { outline: 2px solid var(--primary); background-color: #ffffff; }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            font-size: 0.875rem;
            transition: background-color 0.2s;
        }
        .btn-primary { background-color: var(--primary); color: white; font-size: 1rem; padding: 0.75rem 1.5rem; }
        .btn-primary:hover { background-color: var(--primary-hover); }
        .btn-secondary { background-color: #374151; color: white; border: 1px solid #4b5563; font-size: 0.75rem; }
        .btn-secondary:hover { background-color: #4b5563; }
        .btn-del { background: none; border: none; color: #f87171; cursor: pointer; font-weight: bold; font-size: 1rem; }
        .btn-del:hover { color: #ef4444; }

        .control-panel { background-color: var(--bg-card); padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border); margin-bottom: 1.5rem; }
        .file-label {
            background-color: #374151; color: #e5e7eb; padding: 0.5rem 1rem;
            border-radius: 0.375rem; cursor: pointer; font-size: 0.875rem; border: 1px solid #4b5563;
            display: inline-flex; align-items: center; gap: 0.5rem;
        }
        .file-label:hover { background-color: #4b5563; }

        .required { color: #f87171; margin-left: 2px; }
        .text-xs { font-size: 0.75rem; }
        .text-orange { color: #fb923c; }
        .text-green { color: #4ade80; }
        .text-red { color: #f87171; }
        
        .header-logo-text h1 { margin: 0; font-size: 1.125rem; }
        .header-logo-text p { margin: 0; font-size: 0.75rem; color: #fb923c; opacity: 0.9; }
    </style>
</head>
<body>

    <!-- DISCLAIMER -->
    <div class="disclaimer">
        The tool created by Mallikarjunagowda Gowdara, Chief Manager, Bank of Baroda. This is only for educational purpose, and this do not endorse the official Form 135 format.
    </div>

    <!-- Navbar -->
    <nav class="navbar">
        <div class="container flex justify-between items-center" style="padding: 0;">
            <div class="flex items-center gap-4">
                <img id="logoPreview" src="" style="height: 40px; display: none; background: white; padding: 2px; border-radius: 4px;">
                <div id="defaultLogoIcon" style="background:#ea580c; color:white; padding: 5px 10px; border-radius: 4px; font-weight:bold; font-size: 1.2rem;">B</div>
                <div class="header-logo-text">
                    <h1>Bank of Baroda</h1>
                    <p>Form No. 135 (New Format)</p>
                </div>
            </div>
            <button onclick="validateAndGenerate()" class="btn" style="background: white; color: #ea580c;">
                Download PDF
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        
        <!-- Controls -->
        <div class="control-panel flex flex-wrap gap-4 items-center">
             <label class="file-label">
                Upload Logo
                <input type="file" id="logoUpload" accept="image/*" class="hidden" onchange="handleLogoUpload(this)">
            </label>
            
            <label class="file-label">
                Upload Applicant Photo
                <input type="file" id="photoUpload" accept="image/*" class="hidden" onchange="handlePhotoUpload(this)">
            </label>
            
            <div id="photoPreviewContainer" class="hidden flex items-center gap-2 text-xs text-green">
                 <span>âœ” Photo Loaded</span>
                 <img id="applicantPhotoPreview" style="height: 32px; width: 32px; object-fit: cover; border-radius: 50%; border: 1px solid gray;">
            </div>
            
            <div class="w-full text-xs text-muted mt-2">
                For GitHub/Offline: Place 'logo.png' in the same folder as this file.
            </div>
        </div>

        <form id="bankForm" oninput="calculateNetWorth()">
            
            <!-- Header Info -->
            <div class="form-section">
                <div class="grid grid-cols-2">
                    <div class="input-group">
                        <label class="input-label">Branch Name</label>
                        <input type="text" id="branchName" class="form-input" placeholder="Enter Branch Name">
                    </div>
                    <div class="input-group">
                        <label class="input-label">As At Date</label>
                        <input type="date" id="asAtDate" class="form-input">
                    </div>
                </div>
            </div>

            <!-- 1-3. Personal -->
            <div class="form-section">
                <h2 class="section-title">1-3. Personal Details</h2>
                <div class="grid grid-cols-2">
                    <div class="input-group col-span-2">
                        <label class="input-label">1. Name in Full <span class="required">*</span></label>
                        <input type="text" id="fullName" class="form-input" required>
                    </div>
                    <div class="input-group">
                        <label class="input-label">2. Date of Birth <span class="required">*</span></label>
                        <input type="date" id="dob" class="form-input" onchange="calculateAge()" required>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Age</label>
                        <input type="text" id="age" class="form-input" readonly>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Place of Birth</label>
                        <input type="text" id="pob" class="form-input">
                    </div>
                    <div class="input-group">
                        <label class="input-label">3(a). Father's / Husband's Name</label>
                        <input type="text" id="fatherName" class="form-input">
                    </div>
                    <div class="input-group">
                        <label class="input-label">3(b). Mother's Name <span class="required">*</span></label>
                        <input type="text" id="motherName" class="form-input" required>
                    </div>
                </div>
            </div>

            <!-- 4-5. Address & Contact -->
            <div class="form-section">
                <h2 class="section-title">4-5. Address & Contact</h2>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="input-label">4. Permanent Address <span class="required">*</span></label>
                        <textarea id="permAddress" rows="3" class="form-input" required minlength="20"></textarea>
                        <input type="text" id="permPin" placeholder="Pin Code" class="form-input mt-2" oninput="validateNumber(this)">
                    </div>
                    <div>
                        <label class="input-label">Present Address <span class="required">*</span></label>
                        <textarea id="currAddress" rows="3" class="form-input" required minlength="20"></textarea>
                        <input type="text" id="currPin" placeholder="Pin Code" class="form-input mt-2" oninput="validateNumber(this)">
                    </div>
                </div>
                <div class="grid grid-cols-3 gap-4 mt-4">
                    <div class="input-group">
                        <label class="input-label">5. Office/Shop Tel</label>
                        <input type="text" id="telOffice" class="form-input" oninput="validateNumber(this)">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Residence Tel</label>
                        <input type="text" id="telResi" class="form-input" oninput="validateNumber(this)">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Mobile No <span class="required">*</span></label>
                        <input type="text" id="mobile" class="form-input" required oninput="validateNumber(this)">
                    </div>
                </div>
            </div>

            <!-- 6. Occupation -->
            <div class="form-section">
                <h2 class="section-title">6. Occupation / Line of Business</h2>
                <div class="mb-4">
                    <label class="input-label">Select Type</label>
                    <select id="occType" class="form-input" onchange="toggleOccupationFields()">
                        <option value="service">A. Service</option>
                        <option value="business">B. Business / Professional</option>
                    </select>
                </div>

                <!-- A. Service -->
                <div id="serviceFields" class="grid grid-cols-2 gap-4">
                    <div class="input-group col-span-2">
                        <label class="input-label">Name of Employer & Address</label>
                        <textarea id="empDetails" rows="2" class="form-input"></textarea>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Designation</label>
                        <input type="text" id="designation" class="form-input">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Working Since</label>
                        <input type="text" id="workingSince" class="form-input">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Salary A/c No. (Savings Bank)</label>
                        <input type="text" id="salaryAcc" class="form-input" oninput="validateNumber(this)">
                    </div>
                </div>

                <!-- B. Business -->
                <div id="businessFields" class="hidden grid grid-cols-2 gap-4">
                    <div class="input-group col-span-2">
                        <label class="input-label">i) Name of Firm/Company & Address</label>
                        <textarea id="firmDetails" rows="2" class="form-input"></textarea>
                    </div>
                    <div class="input-group">
                        <label class="input-label">ii) Line of Activities</label>
                        <input type="text" id="lineActivity" class="form-input">
                    </div>
                    <div class="input-group">
                        <label class="input-label">iii) Established Since</label>
                        <input type="text" id="established" class="form-input">
                    </div>
                    <div class="input-group">
                        <label class="input-label">iv) Capacity Representing</label>
                        <input type="text" id="capacity" class="form-input">
                    </div>
                </div>
            </div>

            <!-- 7-8 Income & PAN -->
            <div class="form-section">
                <div class="grid grid-cols-2 gap-4">
                    <div class="input-group">
                        <label class="input-label">7. Annual Income (Rs.) <span class="required">*</span></label>
                        <input type="text" id="income" class="form-input" required oninput="validateNumber(this)">
                    </div>
                    <div class="input-group">
                        <label class="input-label">8. PAN Number</label>
                        <input type="text" id="pan" class="form-input uppercase">
                    </div>
                </div>
            </div>

            <!-- 9.1 Immovable -->
            <div class="form-section">
                <h2 class="section-title">9. Details of Assets</h2>
                
                <h3 class="text-xs font-bold text-gray-400 mb-2">9.1 Immovable Properties</h3>
                <div class="table-wrapper">
                    <table id="immovableTable">
                        <thead>
                            <tr>
                                <th>(A) Nature</th>
                                <th>(B) Location</th>
                                <th>(C) Owner Name</th>
                                <th>(D) Cost (Rs)</th>
                                <th>(E) Mkt Value (Rs)</th>
                                <th>(F) Encumbrance</th>
                                <th class="w-8"></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <button type="button" onclick="addImmovableRow()" class="btn btn-secondary">+ Add Property</button>
            </div>

            <!-- 9.2 Movable -->
            <div class="form-section">
                <h3 class="text-xs font-bold text-gray-400 mb-2">9.2 Movable Properties</h3>
                
                <!-- A. LIC -->
                <div class="mb-6">
                    <label class="input-label">A. LIC Policies</label>
                    <div class="table-wrapper">
                        <table id="licTable">
                            <thead>
                                <tr>
                                    <th>Policy No</th>
                                    <th>Issue Date</th>
                                    <th>Sum Assured</th>
                                    <th>Branch</th>
                                    <th>Premium (Rs)</th>
                                    <th>Paid Up To (Date)</th>
                                    <th>Surrender Val (Net Worth)</th>
                                    <th class="w-8"></th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <button type="button" onclick="addLicRow()" class="btn btn-secondary">+ Add Policy</button>
                </div>

                <!-- B. Shares -->
                <div class="mb-6">
                    <label class="input-label">B. Shares / Debentures</label>
                    <div class="table-wrapper">
                        <table id="shareTable">
                            <thead>
                                <tr>
                                    <th>Company</th>
                                    <th>No. Held</th>
                                    <th>Cert/Acc No</th>
                                    <th>Face Value (Total)</th>
                                    <th>Paid? (Yes/No)</th>
                                    <th>Mkt Value (Net Worth)</th>
                                    <th class="w-8"></th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <button type="button" onclick="addShareRow()" class="btn btn-secondary">+ Add Share</button>
                </div>

                <!-- C. Term Deposits -->
                <div class="mb-6">
                    <label class="input-label">C. Term Deposits</label>
                    <div class="table-wrapper">
                        <table id="depositTable">
                            <thead>
                                <tr>
                                    <th>FDR/RD No</th>
                                    <th>Date</th>
                                    <th>Fvg.</th>
                                    <th>Amount (Net Worth)</th>
                                    <th>Bank/Branch</th>
                                    <th>Due Date</th>
                                    <th>Maturity Val</th>
                                    <th class="w-8"></th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <button type="button" onclick="addDepositRow()" class="btn btn-secondary">+ Add Deposit</button>
                </div>

                <!-- D. Govt Securities -->
                <div class="mb-4">
                    <label class="input-label">D. Govt Securities (Bonds/NSC)</label>
                    <div class="table-wrapper">
                        <table id="bondTable">
                            <thead>
                                <tr>
                                    <th>Bond/Cert No</th>
                                    <th>Pur. Date</th>
                                    <th>Issuing Office</th>
                                    <th>Amount (Rs)</th>
                                    <th>Due Date</th>
                                    <th>Maturity Val</th>
                                    <th class="w-8"></th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <button type="button" onclick="addBondRow()" class="btn btn-secondary">+ Add Bond</button>
                </div>
            </div>

            <!-- 9.3 - 9.6 Other Assets -->
            <div class="form-section">
                <h3 class="text-xs font-bold text-gray-400 mb-2">9.3 Vehicles</h3>
                <div class="table-wrapper">
                    <table id="vehTable">
                        <thead>
                            <tr>
                                <th>Reg No</th>
                                <th>Type</th>
                                <th>Value (Rs)</th>
                                <th class="w-8"></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <button type="button" onclick="addVehRow()" class="btn btn-secondary mb-4">+ Add Vehicle</button>

                <h3 class="text-xs font-bold text-gray-400 mb-2">9.4 Capital Investment in Business</h3>
                <div class="table-wrapper">
                    <table id="capTable">
                        <thead>
                            <tr>
                                <th>Name of Firm/Company</th>
                                <th>Investment Amount (Rs)</th>
                                <th class="w-8"></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <button type="button" onclick="addCapRow()" class="btn btn-secondary mb-4">+ Add Investment</button>

                <h3 class="text-xs font-bold text-gray-400 mb-2">9.5 Other Investments (Jewellery, etc.)</h3>
                <div class="table-wrapper">
                    <table id="otherInvTable">
                        <thead>
                            <tr>
                                <th>Jewellery (Rs)</th>
                                <th>Inv. in Other Business (Rs)</th>
                                <th>Others (Rs)</th>
                                <th class="w-8"></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <button type="button" onclick="addOtherInvRow()" class="btn btn-secondary">+ Add Row</button>
            </div>

            <!-- 10. Loans -->
            <div class="form-section">
                <h2 class="section-title">10. Details of Loans (Individual/Firm/Company)</h2>
                <div class="table-wrapper">
                    <table id="loanTable">
                        <thead>
                            <tr>
                                <th>(A) Bank/Inst Name</th>
                                <th>(B) Purpose & Amount</th>
                                <th>(C) Security/Repayment</th>
                                <th>(D) Present Bal (Liab)</th>
                                <th>(E) Other Liabilities</th>
                                <th class="w-8"></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <button type="button" onclick="addLoanRow()" class="btn btn-secondary">+ Add Loan</button>
            </div>

            <!-- 11. Other Details (Guarantees) -->
            <div class="form-section">
                <h2 class="section-title">11. Other Details (Guarantees Given)</h2>
                <div class="table-wrapper">
                    <table id="guaranteeTable">
                        <thead>
                            <tr>
                                <th>Name of Bank/Inst</th>
                                <th>On Whose Behalf</th>
                                <th>Amount of Guarantee</th>
                                <th>Status (Std/NPA)</th>
                                <th class="w-8"></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <button type="button" onclick="addGuaranteeRow()" class="btn btn-secondary">+ Add Guarantee</button>
            </div>

            <!-- Net Worth Summary -->
            <div class="form-section">
                <h2 class="section-title text-center">NET WORTH SUMMARY</h2>
                <div class="grid grid-cols-3 gap-4">
                    <div class="calc-box">
                        <div class="calc-label">Total Assets (9.6)</div>
                        <div class="calc-value text-green" id="dispTotalAssets">â‚¹ 0</div>
                    </div>
                    <div class="calc-box">
                        <div class="calc-label">Total Liabilities</div>
                        <div class="calc-value text-red" id="dispTotalLiab">â‚¹ 0</div>
                    </div>
                    <div class="calc-box" style="border-color: #f97316;">
                        <div class="calc-label text-orange">Net Worth</div>
                        <div class="calc-value" id="dispNetWorth">â‚¹ 0</div>
                    </div>
                </div>
            </div>

            <!-- 12. Legal Heirs -->
            <div class="form-section">
                <h2 class="section-title">12. Particulars of Legal Heirs</h2>
                
                <h3 class="text-xs font-bold text-gray-400 mb-2">(A) Details</h3>
                <div class="table-wrapper">
                    <table id="heirTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Relationship</th>
                                <th>DOB</th>
                                <th>Age (Auto)</th>
                                <th>Occupation</th>
                                <th>Address</th>
                                <th class="w-8"></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <button type="button" onclick="addHeirRow()" class="btn btn-secondary">+ Add Heir</button>

                <h3 class="text-xs font-bold text-gray-400 mt-4 mb-2">(B) Nomination Particulars</h3>
                <div class="table-wrapper">
                    <table id="nominationTable">
                        <thead>
                            <tr>
                                <th>Desc of Asset</th>
                                <th>Bank/Org</th>
                                <th>Acc/Cert No</th>
                                <th>Amount</th>
                                <th class="w-8"></th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <button type="button" onclick="addNominationRow()" class="btn btn-secondary">+ Add Nomination</button>
            </div>

            <!-- 13. Declaration -->
            <div class="form-section">
                <h2 class="section-title">13. Declaration</h2>
                
                <div style="background-color: #374151; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                    <p style="font-weight: bold; margin-bottom: 0.5rem; font-size: 0.9rem;">In support of my above declaration, I enclose:</p>
                    <div style="font-size: 0.8rem; color: #d1d5db; line-height: 1.5;">
                        <p>1. Balance sheet, Profit and Loss Accounts, Trading Account, Capital Account (audited/unaudited).</p>
                        <p>2. Copy of employment certificated with details of salary drawn.</p>
                        <p>3. Copies of agreement/revenue records/society certificates in respect of land/ building/flat owned by me.</p>
                        <p>4. Copies of Income Tax/Wealth tax returns/ Assessment Order.</p>
                    </div>
                </div>

                <div style="font-size: 0.8rem; color: #d1d5db; line-height: 1.6; background-color: #374151; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                    I declare that I am/I am not (tick as applicable) a Director in ____/any Bank. There is no litigation against me or the firm/ Co. in which I am the proprietor/ a partner/ a Director.
                    The name of the firm /Co. or the name of the partners/Proprietor/Director of the firm/ Co. is not the caution list of RBI/ECGC.
                    The proprietor/partners/directors of the firm/Co. is/are not the Directors in any Co-operative Bank.
                    I also declare that the above information is complete, true and correct.
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="input-group">
                        <label class="input-label">Place</label>
                        <input type="text" id="signPlace" class="form-input">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Date</label>
                        <input type="date" id="signDate" class="form-input">
                    </div>
                </div>
            </div>

            <!-- Submit -->
            <div class="flex justify-center mt-4">
                <button type="button" onclick="validateAndGenerate()" class="btn btn-primary">
                    <span style="font-size: 1.2rem; margin-right: 0.5rem;">ðŸ“„</span> Generate Form 135 PDF
                </button>
            </div>

        </form>
    </div>

    <script>
        // --- JS Logic ---
        let logoBase64 = "";
        let applicantPhotoBase64 = "";

        const GITHUB_LOGO_PATH = "logo.png";
        const REMOTE_LOGO_URL = "https://bankofbaroda.bank.in/about-us/-/media/Project/BOB/CountryWebsites/India/about-us/overview/BOB-New-Logo-2026-Eng.png";

        window.onload = function() {
            // Check if jsPDF exists
            if (typeof window.jspdf === 'undefined' || !window.jspdf.jsPDF) {
                console.error("jsPDF library not found. Please follow the offline instructions.");
            }

            addImmovableRow();
            addLicRow();
            addShareRow();
            addDepositRow();
            addBondRow();
            addVehRow();
            addCapRow();
            addOtherInvRow();
            addLoanRow();
            addGuaranteeRow();
            addHeirRow();
            addNominationRow();
            toggleOccupationFields();

            const img = new Image();
            img.crossOrigin = "Anonymous";
            img.onload = () => convertAndSetLogo(img);
            img.onerror = () => {
                const remote = new Image();
                remote.crossOrigin = "Anonymous";
                remote.onload = () => convertAndSetLogo(remote);
                remote.src = REMOTE_LOGO_URL;
            };
            img.src = GITHUB_LOGO_PATH;
        };

        function convertAndSetLogo(img) {
            const canvas = document.createElement('canvas');
            canvas.width = img.width; 
            canvas.height = img.height;
            canvas.getContext('2d').drawImage(img, 0, 0);
            try {
                logoBase64 = canvas.toDataURL('image/png');
                document.getElementById('logoPreview').src = logoBase64;
                document.getElementById('logoPreview').classList.remove('hidden');
                document.getElementById('defaultLogoIcon').classList.add('hidden');
            } catch(e) {}
        }

        function handleLogoUpload(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    logoBase64 = e.target.result;
                    document.getElementById('logoPreview').src = logoBase64;
                    document.getElementById('logoPreview').classList.remove('hidden');
                    document.getElementById('defaultLogoIcon').classList.add('hidden');
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function handlePhotoUpload(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    applicantPhotoBase64 = e.target.result;
                    document.getElementById('applicantPhotoPreview').src = applicantPhotoBase64;
                    document.getElementById('photoPreviewContainer').classList.remove('hidden');
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function validateNumber(input) {
            input.value = input.value.replace(/[^0-9]/g, '');
            calculateNetWorth(); 
        }

        function createDeleteBtn(onClick) {
            return `<button type="button" onclick="${onClick}; calculateNetWorth()" class="btn-del">X</button>`;
        }

        function formatDate(dateStr) {
            if(!dateStr) return "";
            const parts = dateStr.split('-');
            return parts.length === 3 ? `${parts[2]}-${parts[1]}-${parts[0]}` : dateStr;
        }

        function calculateAge() {
            const dobVal = document.getElementById('dob').value;
            if(!dobVal) return;
            const dob = new Date(dobVal);
            const today = new Date();
            let y = today.getFullYear() - dob.getFullYear();
            let m = today.getMonth() - dob.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < dob.getDate())) {
                y--; m += 12;
            }
            if (today.getDate() < dob.getDate()) m--;
            document.getElementById('age').value = `${y} Yrs ${m < 0 ? m+12 : m} Mths`;
        }

        function calculateHeirAge(dobInput) {
            const row = dobInput.closest('tr');
            const ageInput = row.cells[3].querySelector('input'); 
            if(!dobInput.value) return;
            
            const dob = new Date(dobInput.value);
            const today = new Date();
            let ageYears = today.getFullYear() - dob.getFullYear();
            let ageMonths = today.getMonth() - dob.getMonth();
            let ageDays = today.getDate() - dob.getDate();

            if (ageMonths < 0 || (ageMonths === 0 && ageDays < 0)) {
                ageYears--; ageMonths += 12;
            }
            if (ageDays < 0) {
                ageMonths--; if(ageMonths < 0) ageMonths += 12;
            }
            ageInput.value = `${ageYears} Yrs ${ageMonths} Mths`;
        }

        function toggleOccupationFields() {
            const type = document.getElementById('occType').value;
            if(type === 'service') {
                document.getElementById('serviceFields').classList.remove('hidden');
                document.getElementById('businessFields').classList.add('hidden');
            } else {
                document.getElementById('serviceFields').classList.add('hidden');
                document.getElementById('businessFields').classList.remove('hidden');
            }
        }

        function copyAddress(btn) {
            const row = btn.closest('tr');
            const addrInput = row.querySelector('.heir-addr');
            const presentAddr = document.getElementById('currAddress').value;
            const presentPin = document.getElementById('currPin').value;
            addrInput.value = presentAddr + (presentPin ? `, ${presentPin}` : '');
        }

        // --- Dynamic Row Adders ---
        function addImmovableRow() {
            const tbody = document.querySelector('#immovableTable tbody');
            tbody.insertRow().innerHTML = `
                <td><select class="table-input"><option>Plot</option><option>Agri Land</option><option>House</option><option>Other</option></select></td>
                <td><input class="table-input" placeholder="Survey/Area"></td>
                <td><input class="table-input" placeholder="Name"></td>
                <td><input type="text" class="table-input" placeholder="0" oninput="validateNumber(this)"></td>
                <td><input type="text" class="table-input asset-val" placeholder="0" oninput="validateNumber(this)"></td>
                <td><input class="table-input"></td>
                <td class="text-center">${createDeleteBtn('this.closest("tr").remove()')}</td>`;
        }

        function addLicRow() { 
            const tbody = document.querySelector('#licTable tbody');
            tbody.insertRow().innerHTML = `
                <td><input class="table-input" placeholder="No"></td>
                <td><input type="date" class="table-input"></td>
                <td><input type="text" class="table-input" oninput="validateNumber(this)"></td>
                <td><input class="table-input"></td>
                <td><input type="text" class="table-input" oninput="validateNumber(this)"></td>
                <td><input type="date" class="table-input"></td>
                <td><input type="text" class="table-input asset-val" placeholder="0" oninput="validateNumber(this)"></td>
                <td class="text-center">${createDeleteBtn('this.closest("tr").remove()')}</td>`;
        }

        function addShareRow() { 
            document.querySelector('#shareTable tbody').insertRow().innerHTML = `
                <td><input class="table-input" placeholder="Co Name"></td>
                <td><input type="text" class="table-input" oninput="validateNumber(this)"></td>
                <td><input class="table-input"></td>
                <td><input type="text" class="table-input" oninput="validateNumber(this)"></td>
                <td><select class="table-input"><option>Yes</option><option>No</option></select></td>
                <td><input type="text" class="table-input asset-val" placeholder="0" oninput="validateNumber(this)"></td>
                <td class="text-center">${createDeleteBtn('this.closest("tr").remove()')}</td>`;
        }

        function addDepositRow() { 
            document.querySelector('#depositTable tbody').insertRow().innerHTML = `
                <td><input class="table-input"></td>
                <td><input type="date" class="table-input"></td>
                <td><input class="table-input"></td>
                <td><input type="text" class="table-input asset-val" placeholder="0" oninput="validateNumber(this)"></td>
                <td><input class="table-input"></td>
                <td><input type="date" class="table-input"></td>
                <td><input type="text" class="table-input" oninput="validateNumber(this)"></td>
                <td class="text-center">${createDeleteBtn('this.closest("tr").remove()')}</td>`;
        }

        function addBondRow() { 
            document.querySelector('#bondTable tbody').insertRow().innerHTML = `
                <td><input class="table-input"></td>
                <td><input type="date" class="table-input"></td>
                <td><input class="table-input"></td>
                <td><input type="text" class="table-input asset-val" placeholder="0" oninput="validateNumber(this)"></td>
                <td><input type="date" class="table-input"></td>
                <td><input type="text" class="table-input" oninput="validateNumber(this)"></td>
                <td class="text-center">${createDeleteBtn('this.closest("tr").remove()')}</td>`;
        }

        function addVehRow() { 
            document.querySelector('#vehTable tbody').insertRow().innerHTML = `
                <td><input class="table-input"></td>
                <td><input class="table-input"></td>
                <td><input type="text" class="table-input asset-val" placeholder="0" oninput="validateNumber(this)"></td>
                <td class="text-center">${createDeleteBtn('this.closest("tr").remove()')}</td>`;
        }

        function addCapRow() { 
            document.querySelector('#capTable tbody').insertRow().innerHTML = `
                <td><input class="table-input"></td>
                <td><input type="text" class="table-input asset-val" placeholder="0" oninput="validateNumber(this)"></td>
                <td class="text-center">${createDeleteBtn('this.closest("tr").remove()')}</td>`;
        }

        function addOtherInvRow() { 
            document.querySelector('#otherInvTable tbody').insertRow().innerHTML = `
                <td><input type="text" class="table-input asset-val" placeholder="0" oninput="validateNumber(this)"></td>
                <td><input type="text" class="table-input asset-val" placeholder="0" oninput="validateNumber(this)"></td>
                <td><input type="text" class="table-input asset-val" placeholder="0" oninput="validateNumber(this)"></td>
                <td class="text-center">${createDeleteBtn('this.closest("tr").remove()')}</td>`;
        }

        function addLoanRow() { 
            document.querySelector('#loanTable tbody').insertRow().innerHTML = `
                <td><input class="table-input"></td>
                <td><input class="table-input"></td>
                <td><input class="table-input"></td>
                <td><input type="text" class="table-input liab-val" placeholder="0" oninput="validateNumber(this)"></td>
                <td><input type="text" class="table-input liab-val" placeholder="0" oninput="validateNumber(this)"></td>
                <td class="text-center">${createDeleteBtn('this.closest("tr").remove()')}</td>`;
        }

        function addGuaranteeRow() { 
            document.querySelector('#guaranteeTable tbody').insertRow().innerHTML = `
                <td><input class="table-input"></td>
                <td><input class="table-input"></td>
                <td><input type="text" class="table-input" oninput="validateNumber(this)"></td>
                <td><select class="table-input"><option>Standard</option><option>NPA</option></select></td>
                <td class="text-center">${createDeleteBtn('this.closest("tr").remove()')}</td>`;
        }

        function addHeirRow() { 
            document.querySelector('#heirTable tbody').insertRow().innerHTML = `
                <td><input class="table-input"></td>
                <td><input class="table-input"></td>
                <td><input type="date" class="table-input" onchange="calculateHeirAge(this)"></td>
                <td><input class="table-input" style="width:80px; background:#e5e7eb" readonly></td>
                <td><input class="table-input"></td>
                <td><textarea class="table-input heir-addr" rows="1"></textarea><button type="button" onclick="copyAddress(this)" class="btn-secondary" style="margin-top:2px;">Copy Present</button></td>
                <td class="text-center">${createDeleteBtn('this.closest("tr").remove()')}</td>`;
        }

        function addNominationRow() { 
            document.querySelector('#nominationTable tbody').insertRow().innerHTML = `
                <td><input class="table-input"></td>
                <td><input class="table-input"></td>
                <td><input class="table-input"></td>
                <td><input type="text" class="table-input" oninput="validateNumber(this)"></td>
                <td class="text-center">${createDeleteBtn('this.closest("tr").remove()')}</td>`;
        }

        function calculateNetWorth() {
            let assets = 0, liabs = 0;
            document.querySelectorAll('.asset-val').forEach(i => assets += Number(i.value) || 0);
            document.querySelectorAll('.liab-val').forEach(i => liabs += Number(i.value) || 0);
            document.getElementById('dispTotalAssets').innerText = 'â‚¹ ' + assets.toLocaleString('en-IN');
            document.getElementById('dispTotalLiab').innerText = 'â‚¹ ' + liabs.toLocaleString('en-IN');
            document.getElementById('dispNetWorth').innerText = 'â‚¹ ' + (assets - liabs).toLocaleString('en-IN');
        }

        function getTableData(id) {
            return Array.from(document.querySelectorAll(`#${id} tbody tr`)).map(row => 
                Array.from(row.querySelectorAll('input, select, textarea')).map(input => {
                    if(input.type === 'date') return formatDate(input.value);
                    return (input.value || '').toUpperCase();
                })
            ).filter(row => row.some(cell => cell !== ""));
        }

        function validateAndGenerate() {
            if (!window.jspdf) {
                alert("Error: jsPDF not found. Please ensure files are in the same folder.");
                return;
            }
            const form = document.getElementById('bankForm');
            if(form.checkValidity()) generatePDF();
            else form.reportValidity();
        }

        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const pageWidth = doc.internal.pageSize.getWidth();
            let y = 15;

            // Logo & Header
            if(logoBase64) {
                const imgW = 75; const imgH = 75 / 2.44;
                doc.addImage(logoBase64, 'PNG', (pageWidth - imgW)/2, 10, imgW, imgH);
                y += imgH + 5;
            } else y += 15;

            doc.setFontSize(10).setFont("helvetica", "normal");
            doc.text("(Head Office: Mandvi, Baroda)", pageWidth/2, y, { align: "center" }); y += 4;
            doc.setLineWidth(0.5); doc.line(10, y, 200, y); y += 6;

            doc.setFontSize(11).setFont("helvetica", "bold");
            doc.text("Form 135", pageWidth/2, y, {align: 'center'}); y += 6;
            
            doc.setFontSize(10).setFont("helvetica", "normal");
            const branch = document.getElementById('branchName').value.toUpperCase();
            doc.text(`BRANCH: ${branch}`, 14, y); y += 6;

            // Title + Photo in Header (Top Right)
            const title = "PARTICULARS TO BE SUPPLIED BY APPLICANT/ Directors/ partners/ Prop. , Guarantor FOR ADVANCES";
            doc.setFont("helvetica", "bold");
            
            const photoW = 35;
            const photoH = 45;
            const photoX = pageWidth - 14 - photoW; 
            const photoY = 15; // Placed at top right, near logo vertical start
            
            doc.text(doc.splitTextToSize(title, 130), 14, y);
            
            if (applicantPhotoBase64) {
                 try { doc.addImage(applicantPhotoBase64, 'JPEG', photoX, photoY, photoW, photoH); } catch(e) {}
                 doc.rect(photoX, photoY, photoW, photoH);
            } else {
                doc.rect(photoX, photoY, photoW, photoH);
                doc.setFontSize(8).text("Photo", photoX+12, photoY+25);
            }
            
            y += 15; 
            doc.setFontSize(10).setFont("helvetica", "normal");
            const asAt = formatDate(document.getElementById('asAtDate').value);
            doc.text(`I give below the particulars of myself, my family and my Assets & Liabilities as at ${asAt}.`, 14, y); y += 8;

            // Field Helper
            const printField = (lbl, val, x=14) => {
                doc.setFont("helvetica", "bold").text(lbl, x, y);
                doc.setFont("helvetica", "normal").text(val || "", x + doc.getTextWidth(lbl) + 2, y);
            };

            printField("1. Name in Full: ", document.getElementById('fullName').value.toUpperCase()); y += 6;

            const dob = formatDate(document.getElementById('dob').value);
            const age = document.getElementById('age').value.toUpperCase();
            const pob = document.getElementById('pob').value.toUpperCase();
            printField("2. Date of Birth: ", dob);
            printField(" & Age: ", age, 80);
            printField(" Place of Birth: ", pob, 140);
            y += 6;

            printField("3. (a) Father's/Husband's Name: ", document.getElementById('fatherName').value.toUpperCase()); y+=6;
            printField("    (b) Mother's Name: ", document.getElementById('motherName').value.toUpperCase()); y+=6;

            doc.setFont("helvetica", "bold").text("4. Residential Address:", 14, y); y+=5;
            const pAddr = document.getElementById('permAddress').value.toUpperCase() + " PIN: " + document.getElementById('permPin').value;
            const cAddr = document.getElementById('currAddress').value.toUpperCase() + " PIN: " + document.getElementById('currPin').value;
            
            doc.autoTable({
                startY: y,
                head: [['PERMANENT', 'PRESENT']],
                body: [[pAddr, cAddr]],
                theme: 'plain',
                styles: { cellPadding: 1, fontSize: 10 },
                margin: { left: 14, right: 14 }
            });
            y = doc.lastAutoTable.finalY + 6;

            const off = document.getElementById('telOffice').value;
            const res = document.getElementById('telResi').value;
            const mob = document.getElementById('mobile').value;
            doc.text(`5. Telephone: Office: ${off}  Resi: ${res}  Mobile: ${mob}`, 14, y); y += 6;

            const occ = document.getElementById('occType').value;
            doc.text("6. Occupation / Line of Business:", 14, y); y += 5;
            if(occ === 'service') {
                doc.text("A. If in Service:", 14, y); y+=5;
                doc.text(`   Name of Employer: ${document.getElementById('empDetails').value.toUpperCase()}`, 14, y); y+=5;
                doc.text(`   Designation: ${document.getElementById('designation').value.toUpperCase()}`, 14, y); y+=5;
                doc.text(`   Working Since: ${document.getElementById('workingSince').value.toUpperCase()}`, 14, y); y+=5;
                doc.text(`   Salary A/c: ${document.getElementById('salaryAcc').value.toUpperCase()}`, 14, y); y+=6;
            } else {
                doc.text("B. If in Business/Professional:", 14, y); y+=5;
                doc.text(`   i) Firm Name: ${document.getElementById('firmDetails').value.toUpperCase()}`, 14, y); y+=5;
                doc.text(`   ii) Activity: ${document.getElementById('lineActivity').value.toUpperCase()}`, 14, y); y+=5;
                doc.text(`   iii) Since: ${document.getElementById('established').value.toUpperCase()}`, 14, y); y+=5;
                doc.text(`   iv) Capacity: ${document.getElementById('capacity').value.toUpperCase()}`, 14, y); y+=6;
            }

            printField("7. Annual Income: Rs. ", document.getElementById('income').value); y+=6;
            printField("8. PAN: ", document.getElementById('pan').value.toUpperCase()); y+=6;

            doc.setFont("helvetica", "bold").text("9. Details of Assets:", 14, y); y+=5;
            
            doc.setFontSize(9).text("9.1 Details of Immovable Properties:", 14, y);
            doc.autoTable({
                startY: y+2,
                head: [['Nature', 'Location', 'Owner', 'Cost', 'Mkt Val', 'Encumbrance']],
                body: getTableData('immovableTable'),
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [220,220,220], textColor:0 }
            });
            y = doc.lastAutoTable.finalY + 5;

            doc.text("9.2 Details of Movable Properties:", 14, y); y+=4;
            
            doc.text("A. LIC Policies", 14, y);
            doc.autoTable({
                startY: y+1,
                head: [['Policy No', 'Issue Dt', 'Sum Assured', 'Branch', 'Prem', 'Paid Up To', 'Surr Val']],
                body: getTableData('licTable'),
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [220,220,220], textColor:0 }
            });
            y = doc.lastAutoTable.finalY + 5;

            doc.text("B. Shares / Debentures", 14, y);
            doc.autoTable({
                startY: y+1,
                head: [['Company', 'No.', 'Cert/Acc', 'Face Val', 'Paid?', 'Mkt Val']],
                body: getTableData('shareTable'),
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [220,220,220], textColor:0 }
            });
            y = doc.lastAutoTable.finalY + 5;

            if(y > 250) { doc.addPage(); y=20; }

            doc.text("C. Term Deposits", 14, y);
            doc.autoTable({
                startY: y+1,
                head: [['FDR No', 'Date', 'Fvg', 'Amount', 'Bank', 'Due Dt', 'Mat Val']],
                body: getTableData('depositTable'),
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [220,220,220], textColor:0 }
            });
            y = doc.lastAutoTable.finalY + 5;

            doc.text("D. Govt Securities", 14, y);
            doc.autoTable({
                startY: y+1,
                head: [['Bond No', 'Pur Dt', 'Office', 'Amount', 'Due Dt', 'Mat Val']],
                body: getTableData('bondTable'),
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [220,220,220], textColor:0 }
            });
            y = doc.lastAutoTable.finalY + 5;

            doc.text("9.3 Vehicles", 14, y);
            doc.autoTable({
                startY: y+1,
                head: [['Reg No', 'Type', 'Value']],
                body: getTableData('vehTable'),
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [220,220,220], textColor:0 }
            });
            y = doc.lastAutoTable.finalY + 5;

            doc.text("9.4 Capital Investment", 14, y);
            doc.autoTable({
                startY: y+1,
                head: [['Firm Name', 'Amount']],
                body: getTableData('capTable'),
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [220,220,220], textColor:0 }
            });
            y = doc.lastAutoTable.finalY + 5;

            if(y > 250) { doc.addPage(); y=20; }
            doc.text("9.5 Other Investments", 14, y);
            doc.autoTable({
                startY: y+1,
                head: [['Jewellery (Rs)', 'Inv. Other Biz (Rs)', 'Others (Rs)']],
                body: getTableData('otherInvTable'),
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [220,220,220], textColor:0 }
            });
            y = doc.lastAutoTable.finalY + 5;

            const totAssets = document.getElementById('dispTotalAssets').innerText;
            doc.setFont("helvetica", "bold").text(`9.6 Total of all assets: ${totAssets}`, 14, y); y+=8;

            doc.text("10. Details of Loans:", 14, y);
            doc.autoTable({
                startY: y+2,
                head: [['Bank', 'Purpose', 'Security', 'Outstanding', 'Other Liab']],
                body: getTableData('loanTable'),
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [220,220,220], textColor:0 }
            });
            y = doc.lastAutoTable.finalY + 6;

            if(y > 250) { doc.addPage(); y=20; }
            doc.text("11. Other Details (Guarantees Given):", 14, y);
            doc.autoTable({
                startY: y+2,
                head: [['Bank/Inst', 'On Behalf Of', 'Amount', 'Status']],
                body: getTableData('guaranteeTable'),
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [220,220,220], textColor:0 }
            });
            y = doc.lastAutoTable.finalY + 15; // Gap for summary

            if(y > 250) { doc.addPage(); y=20; }
            
            // Net Worth Summary
            doc.setDrawColor(0); doc.setLineWidth(0.5); doc.rect(14, y, 180, 25);
            doc.setFontSize(10).text("NET WORTH SUMMARY", 16, y+6); doc.line(14, y+8, 194, y+8);
            
            const liab = document.getElementById('dispTotalLiab').innerText;
            const net = document.getElementById('dispNetWorth').innerText;
            
            let sumY = y+14;
            doc.setFont("helvetica", "normal");
            doc.text("Total Assets:", 20, sumY); doc.text(totAssets, 180, sumY, {align:'right'}); sumY+=5;
            doc.text("Total Liabilities:", 20, sumY); doc.text(liab, 180, sumY, {align:'right'}); sumY+=6;
            doc.setFont("helvetica", "bold");
            doc.text("Net Worth:", 20, sumY); doc.text(net, 180, sumY, {align:'right'});
            y += 35;

            if(y > 230) { doc.addPage(); y=20; }
            doc.text("12(A). Particulars of Legal Heirs:", 14, y);
            doc.autoTable({
                startY: y+2,
                head: [['Name', 'Rel', 'DOB', 'Age', 'Occ', 'Address']],
                body: getTableData('heirTable'),
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [220,220,220], textColor:0 }
            });
            y = doc.lastAutoTable.finalY + 6;

            doc.text("12(B). Nomination Particulars:", 14, y);
            doc.autoTable({
                startY: y+2,
                head: [['Asset', 'Bank', 'Cert No', 'Amount']],
                body: getTableData('nominationTable'),
                theme: 'grid',
                styles: { fontSize: 8 },
                headStyles: { fillColor: [220,220,220], textColor:0 }
            });
            y = doc.lastAutoTable.finalY + 8;

            if(y > 220) { doc.addPage(); y=20; }
            doc.setFontSize(9).setFont("helvetica", "normal");
            
            doc.text("In support of my above declaration, I enclose:", 14, y); y+=5;
            const encl = [
                "1. Balance sheet, Profit/Loss, Trading, Capital Account.",
                "2. Employment certificate with details of salary drawn.",
                "3. Property agreement/revenue records/society certs.",
                "4. IT/Wealth tax returns/Assessment Order."
            ];
            encl.forEach(e => { doc.text(e, 14, y); y+=5; });
            
            y+=2;
            doc.setFont("helvetica", "bold").text("13. DECLARATION:", 14, y); y+=5;
            doc.setFont("helvetica", "normal");
            const decl = "I declare that I am/I am not (tick as applicable) a Director in ____/any Bank. There is no litigation against me or the firm/ Co. in which I am the proprietor/ a partner/ a Director. The name of the firm /Co. or the name of the partners/Proprietor/Director of the firm/ Co. is not the caution list of RBI/ECGC. The proprietor/partners/directors of the firm/Co. is/are not the Directors in any Co-operative Bank. I also declare that the above information is complete, true and correct.";
            const splitDecl = doc.splitTextToSize(decl, 180);
            doc.text(splitDecl, 14, y);
            y += splitDecl.length * 4 + 10;

            const place = document.getElementById('signPlace').value.toUpperCase();
            const signDate = formatDate(document.getElementById('signDate').value);
            
            doc.text(`Place: ${place}`, 14, y); 
            doc.text(`Signature of Applicant / Guarantor`, 130, y); y+=6;
            doc.text(`Date: ${signDate}`, 14, y);

            doc.save('Form_135_New_Format.pdf');
        }
    </script>
</body>
</html>
